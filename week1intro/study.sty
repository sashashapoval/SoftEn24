\usepackage{listings}
\usepackage{framed}
\usepackage{mdframed}
\renewenvironment{leftbar}[1][\hsize]
{% 
\def\FrameCommand 
{%
{\hspace{-7pt} \color{black} \vrule width 2pt}%
\hspace{0pt}%must no space.
\fboxsep=\FrameSep\colorbox{white}%
}%
\MakeFramed{\hsize#1\advance\hsize-\width\FrameRestore}%
}
{\endMakeFramed}
\setlength{\FrameSep}{5pt}

\newmdenv[topline=false, leftline=false, bottomline=false,%
  linewidth=2pt, innerleftmargin=0pt, rightmargin=-4pt,%
  innerrightmargin=5pt, skipabove=8pt, skipbelow=8pt]{rightbar}

\newmdenv[topline=false, rightline=false, bottomline=false,%
  linewidth=2pt, innerrightmargin=0pt, leftmargin=-4pt,%
  innerleftmargin=5pt, skipabove=8pt, skipbelow=8pt]{mdleftbar}

\definecolor{verbgray}{gray}{0.9}
\lstnewenvironment{code}{%
  \lstset{backgroundcolor=\color{verbgray},
  frame=single,
  framerule=0pt,
  basicstyle=\ttfamily,
  columns=fullflexible}}{}
%\definecolor{shadecolor}{rgb}{.9, .9, .9}

\newcommand{\verbcode}[1]{\colorbox{verbgray}{\texttt{#1}}}

